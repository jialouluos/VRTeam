<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>飞行控件</title>
    <script src="./../build/three.js"></script>
    <script src="./../examples/js/controls/FlyControls.js"></script>
    <script src="./../examples/js/libs/dat.gui.min.js"></script>
    <script src="./../examples/js/libs/stats.min.js"></script>
</head>
<body>
    <script>
        /*  A键和D键控制镜头左右移动
            W键|鼠标左键和S键|鼠标右键控制镜头前进后退
            R键和F键控制镜头的前进后退
            Q键和E键控制镜头沿Z轴进行顺时针和逆时针旋转
            向左键和向右键控制镜头沿Y轴旋转
            向上键和向下键控制镜头沿X轴旋转
        */
        var renderer;
        function initRender()
        {
            renderer = new THREE.WebGLRenderer({antialias:true});
            renderer.setSize(window.innerWidth,window.innerHeight);
            document.body.appendChild(renderer.domElement);
        }

        var scene;
        function initScene()
        {
            scene = new THREE.Scene();
        }

        var camera;
        function initCamera()
        {
            camera = new THREE.PerspectiveCamera(60,window.innerWidth/window.innerHeight,1,1000);
            camera.position.set(18,15,40);
            camera.lookAt(new THREE.Vector3(0,0,0));
        }

        var light;
        function initLight()
        {
            light = new THREE.HemisphereLight( 0xffffbb, 0x080820, 1 );
            light.position.set(50,100,10);
            scene.add(light);
        }

        function initModel()
        {
            //helper
            var helper = new THREE.AxesHelper(30);
            scene.add(helper);
            //平面
            var planeGeometry = new THREE.PlaneGeometry(80,60,1,1);
            var planeMaterial = new THREE.MeshPhongMaterial({color:"RosyBrown",side:THREE.DoubleSide});
            var plane = new THREE.Mesh(planeGeometry,planeMaterial);
            plane.position.set(0,0,0);
            plane.rotation.x -= 0.5*Math.PI;
            scene.add(plane);
            //球体
            var sphereGeometry = new THREE.SphereGeometry(5,50,50);
            var sphereMaterial = new THREE.MeshPhongMaterial({color:"blue"});
            var sphere = new THREE.Mesh(sphereGeometry,sphereMaterial);
            sphere.position.set(0,5,0);
            scene.add(sphere);
            //立方体
            var cubeGeomtry = new THREE.BoxGeometry(5,5,5);
            var cubeMaterial = new THREE.MeshPhongMaterial({color:"pink",side:THREE.DoubleSide});
            var cube = new THREE.Mesh(cubeGeomtry,cubeMaterial);
            cube.position.set(10,3,0);
            scene.add(cube);
        }

        var controls,clock;
        function initControls()
        {
            clock = new THREE.Clock();
            controls = new THREE.FlyControls(camera,renderer.domElement);
            controls.movementSpeed = 100;
            controls.roolSpeed = Math.PI/2;
            controls.autoForward = false;
            controls.dragToLook = false;
        }

        var stats;
        function initStats()
        {
            stats = new Stats();
            document.body.appendChild(stats.dom);
        }

        function render()
        {
            renderer.render(scene,camera);
        }

        function onWindowResize()
        {
            camera.aspect = window.innerWidth/window.innerHeight;
            camera.updateProjectionMatrix();
            render();
            renderer.setSize(window.innerWidth,window.innerHeight);
        }

        function animate()
        {
            var delta = clock.getDelta();
            render();
            stats.update();
            controls.update(delta);
            requestAnimationFrame(animate);
        }

        function draw()
        {
            initRender();
            initScene();
            initCamera();
            initLight();
            initModel();
            initControls();
            initStats();
            
            animate();
            window.onresize = onWindowResize;
        }

        draw();
    </script>
</body>
</html>